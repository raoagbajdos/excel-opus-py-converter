<?xml version="1.0" encoding="UTF-8"?>
<svg width="1000" height="950" viewBox="0 0 1000 950" xmlns="http://www.w3.org/2000/svg">
  <!-- Define gradients and styles -->
  <defs>
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4A90E2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#357ABD;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#5CB85C;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#449D44;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="purpleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9B59B6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8E44AD;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#F39C12;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E67E22;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="redGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#E74C3C;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#C0392B;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Title -->
  <text x="500" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#2C3E50">
    Excel VBA to Python Converter - Architecture
  </text>

  <!-- Frontend Layer -->
  <rect x="50" y="60" width="900" height="100" fill="url(#blueGrad)" rx="10" />
  <text x="500" y="85" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="white">
    Frontend (Web UI)
  </text>
  <text x="500" y="110" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    • File Upload (.xlsm, .xls, .xlsb) • VBA Code Editor • Side-by-Side Comparison
  </text>
  <text x="500" y="130" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    • Formula Extraction • Data Export • Workbook Analysis • Download Python Files
  </text>

  <!-- Arrow from Frontend to Backend -->
  <line x1="500" y1="160" x2="500" y2="190" stroke="#2C3E50" stroke-width="3" marker-end="url(#arrowhead)" />

  <!-- Flask Backend API -->
  <rect x="50" y="190" width="900" height="120" fill="url(#greenGrad)" rx="10" />
  <text x="500" y="215" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="white">
    Flask Backend API
  </text>
  <text x="180" y="240" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    POST /api/upload
  </text>
  <text x="320" y="240" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    POST /api/convert
  </text>
  <text x="460" y="240" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    POST /api/convert-all
  </text>
  <text x="620" y="240" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    POST /api/extract-formulas
  </text>
  <text x="800" y="240" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    POST /api/convert-formula
  </text>
  <text x="250" y="265" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    POST /api/export-data
  </text>
  <text x="500" y="265" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    POST /api/analyze-workbook
  </text>
  <text x="750" y="265" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    GET /api/health
  </text>
  <text x="500" y="290" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white" font-style="italic">
    (Flask 2.3.0+ | Python 3.12 | uv dependency management)
  </text>

  <!-- Arrows from Backend to Processing Modules -->
  <line x1="150" y1="310" x2="150" y2="360" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="310" y1="310" x2="310" y2="360" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="500" y1="310" x2="500" y2="360" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="690" y1="310" x2="690" y2="360" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="850" y1="310" x2="850" y2="360" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />

  <!-- Processing Modules Layer -->
  
  <!-- VBA Extractor -->
  <rect x="50" y="360" width="170" height="180" fill="url(#purpleGrad)" rx="8" />
  <text x="135" y="385" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    VBA Extractor
  </text>
  <text x="135" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    vba_extractor.py
  </text>
  <text x="135" y="430" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • oletools/olevba
  </text>
  <text x="135" y="448" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Manual OLE parsing
  </text>
  <text x="135" y="466" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Module classification
  </text>
  <text x="135" y="484" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Standard/Class/Form
  </text>
  <text x="135" y="502" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Sheet/Workbook modules
  </text>

  <!-- Formula Extractor -->
  <rect x="240" y="360" width="170" height="180" fill="url(#orangeGrad)" rx="8" />
  <text x="325" y="385" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Formula Extractor
  </text>
  <text x="325" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    formula_extractor.py
  </text>
  <text x="325" y="430" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Extract all formulas
  </text>
  <text x="325" y="448" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Formula analysis
  </text>
  <text x="325" y="466" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Cell dependencies
  </text>
  <text x="325" y="484" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Function categorization
  </text>
  <text x="325" y="502" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Statistics generation
  </text>

  <!-- Data Exporter -->
  <rect x="430" y="360" width="170" height="180" fill="url(#blueGrad)" rx="8" />
  <text x="515" y="385" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Data Exporter
  </text>
  <text x="515" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    data_exporter.py
  </text>
  <text x="515" y="430" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Export to pandas
  </text>
  <text x="515" y="448" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Generate Python code
  </text>
  <text x="515" y="466" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Type inference
  </text>
  <text x="515" y="484" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Header detection
  </text>
  <text x="515" y="502" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Multi-sheet support
  </text>

  <!-- Workbook Analyzer -->
  <rect x="620" y="360" width="170" height="180" fill="url(#redGrad)" rx="8" />
  <text x="705" y="385" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Workbook Analyzer
  </text>
  <text x="705" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    workbook_analyzer.py
  </text>
  <text x="705" y="430" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Comprehensive analysis
  </text>
  <text x="705" y="448" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • VBA + Formulas + Data
  </text>
  <text x="705" y="466" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Dependency graph
  </text>
  <text x="705" y="484" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Python recreation
  </text>
  <text x="705" y="502" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Complete migration
  </text>

  <!-- LLM Converter -->
  <rect x="810" y="360" width="140" height="180" fill="#2C3E50" rx="8" />
  <text x="880" y="385" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    LLM Converter
  </text>
  <text x="880" y="408" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    llm_converter.py
  </text>
  <text x="880" y="430" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • VBA → Python
  </text>
  <text x="880" y="448" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Formula → Python
  </text>
  <text x="880" y="466" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Claude API
  </text>
  <text x="880" y="484" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • OpenAI API
  </text>
  <text x="880" y="502" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">
    • Code validation
  </text>

  <!-- Arrows from Processing Modules to LLM -->
  <line x1="220" y1="450" x2="810" y2="450" stroke="#95A5A6" stroke-width="2" stroke-dasharray="5,5" />
  <line x1="410" y1="450" x2="810" y2="450" stroke="#95A5A6" stroke-width="2" stroke-dasharray="5,5" />
  <line x1="600" y1="450" x2="810" y2="450" stroke="#95A5A6" stroke-width="2" stroke-dasharray="5,5" />
  <line x1="790" y1="450" x2="810" y2="450" stroke="#95A5A6" stroke-width="2" stroke-dasharray="5,5" />

  <!-- Arrows from Processing to Output -->
  <line x1="150" y1="540" x2="150" y2="590" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="325" y1="540" x2="325" y2="590" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="515" y1="540" x2="515" y2="590" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="705" y1="540" x2="705" y2="590" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />
  <line x1="880" y1="540" x2="880" y2="590" stroke="#2C3E50" stroke-width="2" marker-end="url(#arrowhead)" />

  <!-- Output Layer -->
  <rect x="50" y="590" width="900" height="140" fill="#34495E" rx="10" />
  <text x="500" y="615" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="white">
    Python Output
  </text>
  <text x="500" y="645" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    • Converted VBA modules → Python functions/classes
  </text>
  <text x="500" y="665" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    • Excel formulas → pandas/numpy operations
  </text>
  <text x="500" y="685" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    • Data → pandas DataFrames with generated Python code
  </text>
  <text x="500" y="705" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    • Complete workbook recreation script with dependencies
  </text>

  <!-- Target Libraries -->
  <rect x="50" y="760" width="900" height="80" fill="#16A085" rx="10" />
  <text x="500" y="785" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
    Target Python Libraries
  </text>
  <text x="200" y="810" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    pandas 2.0.0+
  </text>
  <text x="350" y="810" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    polars 0.20.0+
  </text>
  <text x="500" y="810" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    openpyxl 3.1.0+
  </text>
  <text x="650" y="810" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    numpy
  </text>
  <text x="800" y="810" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">
    datetime
  </text>

  <!-- Technology Stack -->
  <rect x="50" y="870" width="900" height="60" fill="#7F8C8D" rx="10" />
  <text x="500" y="895" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Technology Stack
  </text>
  <text x="500" y="915" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">
    oletools • olefile • zipfile • anthropic (claude-sonnet-4) • openai (gpt-4-turbo) • Flask • Prism.js • uv
  </text>

  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2C3E50" />
    </marker>
  </defs>
</svg>
