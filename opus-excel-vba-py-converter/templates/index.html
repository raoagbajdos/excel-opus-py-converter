<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VBA to Python Converter</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üêç VBA to Python Converter</h1>
            <p class="subtitle">Upload Excel files with macros and convert VBA to idiomatic Python</p>
        </header>

        <main>
            <!-- Upload Section -->
            <section class="upload-section">
                <div class="upload-box" id="dropZone">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Drag & Drop Excel File</h3>
                    <p>or click to browse</p>
                    <p class="file-types">Supported: .xlsm, .xls, .xlsb, .xla, .xlam</p>
                    <input type="file" id="fileInput" accept=".xlsm,.xls,.xlsb,.xla,.xlam" hidden>
                </div>
                <div id="uploadStatus" class="status-message hidden"></div>
            </section>

            <!-- Modules List -->
            <section class="modules-section hidden" id="modulesSection">
                <div class="section-header">
                    <h2>üìã Extracted VBA Modules</h2>
                    <button class="btn btn-primary" id="convertAllBtn">Convert All to Python</button>
                </div>
                <div class="modules-list" id="modulesList"></div>
            </section>

            <!-- Conversion Options -->
            <section class="options-section hidden" id="optionsSection">
                <h3>‚öôÔ∏è Conversion Options</h3>
                <div class="options-grid">
                    <div class="option-group">
                        <label for="targetLibrary">Target Library:</label>
                        <select id="targetLibrary">
                            <option value="pandas">pandas</option>
                            <option value="polars">polars</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>
                            <input type="checkbox" id="includeTypeHints" checked>
                            Include Type Hints
                        </label>
                    </div>
                </div>
            </section>

            <!-- Code Comparison View -->
            <section class="comparison-section hidden" id="comparisonSection">
                <div class="section-header">
                    <h2>üîÑ Code Conversion</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="copyPythonBtn">üìã Copy Python</button>
                        <button class="btn btn-primary" id="downloadPythonBtn">‚¨áÔ∏è Download .py</button>
                    </div>
                </div>
                
                <div class="code-panels">
                    <div class="code-panel vba-panel">
                        <div class="panel-header">
                            <span class="panel-title">VBA Code</span>
                            <span class="module-name" id="vbaModuleName"></span>
                        </div>
                        <pre><code class="language-vbnet" id="vbaCode"></code></pre>
                    </div>
                    
                    <div class="code-panel python-panel">
                        <div class="panel-header">
                            <span class="panel-title">Python Code</span>
                            <span class="status-badge" id="conversionStatus"></span>
                        </div>
                        <pre><code class="language-python" id="pythonCode"></code></pre>
                    </div>
                </div>

                <!-- Conversion Notes -->
                <div class="notes-section hidden" id="notesSection">
                    <h4>üìù Conversion Notes</h4>
                    <ul id="conversionNotes"></ul>
                </div>
            </section>

            <!-- Paste VBA Section -->
            <section class="paste-section">
                <div class="section-header">
                    <h2>‚úèÔ∏è Or Paste VBA Code Directly</h2>
                </div>
                <div class="paste-area">
                    <textarea id="vbaInput" placeholder="Paste your VBA code here...

Example:
Sub CalculateTotal()
    Dim ws As Worksheet
    Dim total As Double
    
    Set ws = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)
    total = Application.WorksheetFunction.Sum(ws.Range(&quot;A1:A10&quot;))
    MsgBox &quot;Total: &quot; &amp; total
End Sub"></textarea>
                    <button class="btn btn-primary" id="convertPastedBtn">Convert to Python</button>
                </div>
            </section>

            <!-- Formula Extraction Section -->
            <section class="formulas-section">
                <div class="section-header">
                    <h2>üî¢ Excel Formula Converter</h2>
                    <p class="subtitle-small">Extract and convert Excel formulas to Python</p>
                </div>
                <div class="formula-upload">
                    <button class="btn btn-primary" id="extractFormulasBtn">
                        üìä Extract Formulas from Excel
                    </button>
                    <input type="file" id="formulaFileInput" accept=".xlsm,.xls,.xlsb,.xla,.xlam,.xlsx" hidden>
                </div>
                <div class="formula-results hidden" id="formulaResults">
                    <h3>Extracted Formulas</h3>
                    <div class="formula-stats" id="formulaStats"></div>
                    <div class="formula-list" id="formulaList"></div>
                </div>
            </section>

            <!-- Data Export Section -->
            <section class="data-export-section">
                <div class="section-header">
                    <h2>üì§ Data Export to Python</h2>
                    <p class="subtitle-small">Export Excel data as pandas DataFrames</p>
                </div>
                <div class="data-export-upload">
                    <button class="btn btn-primary" id="exportDataBtn">
                        üì• Export Data to Python
                    </button>
                    <input type="file" id="dataFileInput" accept=".xlsm,.xls,.xlsb,.xlsx" hidden>
                </div>
                <div class="data-results hidden" id="dataResults">
                    <h3>Exported Data</h3>
                    <div class="data-code-panel">
                        <div class="panel-header">
                            <span class="panel-title">Generated Python Code</span>
                            <button class="btn btn-secondary" id="copyDataCodeBtn">üìã Copy Code</button>
                        </div>
                        <pre><code class="language-python" id="dataCode"></code></pre>
                    </div>
                    <div class="data-metadata" id="dataMetadata"></div>
                </div>
            </section>

            <!-- Complete Workbook Analysis Section -->
            <section class="analysis-section">
                <div class="section-header">
                    <h2>üîç Complete Workbook Analysis</h2>
                    <p class="subtitle-small">Analyze VBA + Formulas + Data and generate comprehensive Python script</p>
                </div>
                <div class="analysis-upload">
                    <button class="btn btn-primary" id="analyzeWorkbookBtn">
                        üöÄ Analyze Complete Workbook
                    </button>
                    <input type="file" id="analysisFileInput" accept=".xlsm,.xls,.xlsb" hidden>
                </div>
                <div class="analysis-results hidden" id="analysisResults">
                    <h3>Workbook Analysis Report</h3>
                    <div class="analysis-summary" id="analysisSummary"></div>
                    <div class="analysis-code-panel">
                        <div class="panel-header">
                            <span class="panel-title">Complete Python Script</span>
                            <button class="btn btn-secondary" id="copyAnalysisCodeBtn">üìã Copy Code</button>
                        </div>
                        <pre><code class="language-python" id="analysisCode"></code></pre>
                    </div>
                    <div class="analysis-report">
                        <h4>Detailed Report</h4>
                        <pre id="analysisReport"></pre>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Powered by Claude AI ‚Ä¢ Built with Flask & Python</p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p id="loadingMessage">Converting...</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-vbnet.min.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
